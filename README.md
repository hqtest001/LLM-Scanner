# 🔍 LLM Scanner

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.8+-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/Platform-Windows%20%7C%20macOS%20%7C%20Linux-green.svg" alt="Platform">
  <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License">
  <img src="https://img.shields.io/badge/Version-1.0.0-red.svg" alt="Version">
</p>

<p align="center">
  <b>本地大语言模型(LLM)服务未授权访问漏洞扫描工具</b>
</p>

<p align="center">
  专注于检测企业内网或本地部署的LLM服务是否存在未授权访问风险
</p>

---

## ⚠️ 免责声明

**本工具仅用于安全研究和授权的渗透测试！**

- 请勿对未授权的目标进行扫描
- 使用本工具进行非法活动产生的一切后果由使用者自行承担
- 本工具仅供安全研究人员、渗透测试人员和系统管理员使用

---

## 📖 项目简介

随着大语言模型(LLM)的普及，越来越多的企业和个人在本地部署了各种LLM服务（如Ollama、vLLM、LM Studio等）。然而，这些服务默认配置往往**没有启用身份认证**，直接暴露在网络中会造成严重的安全隐患：

- 🔓 **敏感数据泄露** - 攻击者可获取模型信息、对话历史
- 💰 **计算资源滥用** - 未授权用户免费使用GPU算力
- 🎯 **提示词注入攻击** - 可能被用于生成恶意内容
- 📡 **横向渗透入口** - 成为攻击内网的跳板

**LLM Scanner** 可以帮助安全人员快速发现网络中存在未授权访问风险的LLM服务。

---

## ✨ 功能特性

### 🎯 支持检测 11 种主流LLM服务

| 服务名称 | 默认端口 | 检测路径 |
|---------|---------|---------|
| **Ollama** | 11434 | /api/tags, /api/version |
| **vLLM** | 8000 | /v1/models, /health |
| **LM Studio** | 1234 | /v1/models |
| **llama.cpp** | 8080 | /health, /v1/models |
| **Mozilla-Llamafile** | 8080 | / |
| **Jan AI** | 1337 | /v1/models |
| **Cortex API** | 1337, 39281 | /v1/models |
| **Local-LLM** | 8000, 8080 | /v1/models |
| **LiteLLM API** | 4000 | /health, /v1/models |
| **GPT4All API Server** | 4891 | /v1/models |
| **OpenAI Compatible API** | 8000, 8080, 3000, 5000 | /v1/models, /v1/chat/completions |

### 🚀 多种扫描模式

- **单个IP扫描** - 精确扫描单个目标
- **IP范围扫描** - 批量扫描IP段（如: `192.168.1.1-192.168.1.254`）
- **CIDR网段扫描** - 扫描整个子网（如: `192.168.1.0/24`）

### 🔧 高级功能

- **全端口扫描** - 检测vLLM服务的非标准端口部署（1024-40000）
- **实时日志** - 扫描过程实时反馈，带颜色分级
- **漏洞详情** - 查看完整的漏洞信息和服务响应
- **结果导出** - JSON格式导出，便于后续分析

### 🎨 双主题支持

- **浅色主题** - 适合日间使用，护眼舒适
- **暗黑主题** - 适合夜间使用，减少眼睛疲劳
- 一键切换，设置自动保存

---

## 📸 界面预览

### 浅色主题
```
┌─────────────────────────────────────────────────────────────────┐
│  LLM Scanner  本地LLM服务未授权访问扫描工具        [🌙 暗黑]    │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌───────────────────────────────────────┐ │
│  │  扫描配置       │  │  扫描日志                             │ │
│  │  ● 单个IP       │  │  [15:30:01] 开始扫描任务              │ │
│  │  ○ IP范围       │  │  [15:30:02] >>> 扫描 192.168.1.100    │ │
│  │  ○ CIDR         │  │  [15:30:03] [!] 发现漏洞: Ollama      │ │
│  │                 │  └───────────────────────────────────────┘ │
│  │  目标地址:      │  ┌───────────────────────────────────────┐ │
│  │  [192.168.1.100]│  │  扫描结果                             │ │
│  │                 │  │  IP地址 | 端口 | 服务 | 状态 | 漏洞   │ │
│  │  ☐ 全端口扫描   │  │  192.168.1.100 | 11434 | Ollama | 🔴  │ │
│  │                 │  └───────────────────────────────────────┘ │
│  │  [开始扫描]     │                                            │
│  └─────────────────┘                                            │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🛠️ 安装与使用

### 环境要求

- Python 3.8+
- Windows / macOS / Linux

### 方式一：源码运行

```bash
# 克隆项目
git clone https://github.com/yourusername/LLMScanner.git
cd LLMScanner

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

### 方式二：直接下载EXE（Windows）

前往 [Releases](https://github.com/hqtest001/LLM-Scanner/releases) 下载最新版本的 `LLM_Scanner_V1.0.exe`

### 方式三：自行打包

```bash
# Windows - 双击运行
build.bat

# 或手动打包
pip install pyinstaller
pyinstaller --onefile --windowed --noconsole --name "LLM_Scanner_V1.0" --add-data "llm_scanner.py;." main.py
```

---

## 📁 项目结构

```
LLMScanner/
├── main.py           # 主程序（UI界面、主题管理）
├── llm_scanner.py    # 扫描引擎（核心扫描逻辑）
├── build.bat         # Windows打包脚本
├── requirements.txt  # Python依赖
├── README.md         # 项目说明
└── theme_config.json # 主题配置（运行时生成）
```

---

## 📋 使用指南

### 快速开始

1. **选择扫描类型** - 单个IP / IP范围 / CIDR
2. **输入目标地址** - 根据提示输入目标
3. **点击"开始扫描"** - 等待扫描完成
4. **查看结果** - 在结果表格中查看发现的漏洞
5. **导出报告** - 点击"导出结果"保存JSON报告

### 示例

| 扫描类型 | 输入示例 | 说明 |
|---------|---------|------|
| 单个IP | `192.168.1.100` | 扫描单台主机 |
| IP范围 | `192.168.1.1-192.168.1.254` | 扫描254台主机 |
| CIDR | `192.168.1.0/24` | 扫描整个C段 |

### 全端口扫描

勾选"启用全端口扫描检测vLLM"后，工具会扫描以下端口范围：
- 1024-1500, 3000-3100, 4000-6000
- 7000-10000, 10000-12000, 30000-40000

> ⚡ 注意：全端口扫描耗时较长，建议仅在必要时启用

---

## 🔒 安全建议

发现未授权访问的LLM服务后，建议采取以下措施：

1. **启用身份认证** - 配置API Key或OAuth认证
2. **限制访问IP** - 使用防火墙限制访问来源
3. **使用反向代理** - 通过Nginx等添加认证层
4. **网络隔离** - 将LLM服务部署在内网隔离区
5. **监控告警** - 配置访问日志和异常告警

---

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

- 🐛 **Bug报告** - 请描述问题现象和复现步骤
- 💡 **功能建议** - 欢迎提出新的检测服务或功能需求
- 📝 **文档改进** - 帮助完善文档和使用说明

---

## 📄 更新日志

### v1.0.0 (2024)
- 🎉 初始版本发布
- ✅ 支持11种主流LLM服务检测
- ✅ 支持单IP/IP范围/CIDR三种扫描模式
- ✅ 支持全端口扫描检测vLLM
- ✅ 支持浅色/暗黑双主题切换
- ✅ 支持JSON格式结果导出
- ✅ 代码模块化（扫描引擎与UI分离）

---

## 📜 开源许可

本项目采用 [MIT License](LICENSE) 开源许可证。

---

## ⭐ Star History

如果这个项目对你有帮助，请点个 Star ⭐ 支持一下！

---

<p align="center">
  Made with ❤️ for Security Research
</p>

